RESEARCHARTICLEA novelattention-basedhybridCNN-RNNarchitectureforsEMG-basedgesturerecognitionYuHuID1, YongkangWongID2, WentaoWei1, YuDu1, MohanKankanhalli3,WeidongGengID1*1StateKeyLabof CAD&CG, Collegeof ComputerScienceandTechnology,ZhejiangUniversity, Hangzhou,China,2SmartSystems Institute,NationalUniversityof Singapore, Singapore, Singapore,3SchoolofComputing,NationalUniversityof Singapore, Singapore, Singapore*gengwd@zju.edu.cnAbstractThesurfaceelectromyography(sEMG)-basedgesturerecognitionwithdeeplearningapproachplaysanincreasinglyimportantrolein human-computerinteraction.ExistingdeeplearningarchitecturesaremainlybasedonConvolutionalNeuralNetwork(CNN)architec-turewhichcapturesspatialinformationof electromyogramsignal.Motivatedbythesequen-tialnatureof electromyogramsignal,weproposeanattention-based hybridCNNandRNN(CNN-RNN)architectureto bettercapturetemporalpropertiesof electromyogramsignalforgesturerecognitionproblem.Moreover,wepresenta newsEMGimagerepresentationmethodbasedona traditionalfeaturevectorwhichenablesdeeplearningarchitecturesto extractimplicitcorrelationsbetweendifferentchannelsforsparsemulti-channelelectro-myogramsignal.ExtensiveexperimentsonfivesEMGbenchmarkdatabasesshowthattheproposedmethodoutperformsallreportedstate-of-the-artmethodsonbothsparsemulti-channelandhigh-densitysEMGdatabases.Tocomparewiththeexistingworks,wesetthewindowlengthto 200msforNinaProDB1andNinaProDB2,and150msforBioPatRecsub-database,CapgMyosub-database,andcsl-hdemgdatabases.Therecognitionaccuraciesof theaforementionedbenchmarkdatabasesare87.0%,82.2%,94.1%,99.7%and94.5%,whichare9.2%,3.5%,1.2%,0.2%and5.2%higherthanthestate-of-the-artperformance,respectively.IntroductionThesurfaceelectromyogramsignal[1]recordsmuscle’sinformationbyputtingnon-invasivesurfacesEMGelectrodesontheskin.TheelectricalactivityrecordedbysEMGelectrodesallowsustodevelophuman-computerinterface(HCI)systemwhichhasbeenemployedinfourmajorareas[2]:(1)Assistivetechnology(e.g.,myoelectriccontrolledprosthesis[3],wheelchair[4]andassistiverobots[5]),(2)Rehabilitativetechnology(e.g.,sEMG-drivenExo-skeletons[6]andseriousgames[7,8]),(3)Inputtechnology(e.g.,armbandsandMCI[9]),and(4)Silentspeechrecognition[10].Amongtheseapplications,sEMG-basedhandgesturePLOSONE| https://doi.org/10.1371/journal.pone.0206049October30,20181 / 18a1111111111a1111111111a1111111111a1111111111a1111111111OPENACCESSCitation:Hu Y, WongY, Wei W, Du Y, KankanhalliM, GengW (2018)A novelattention-based hybridCNN-RNNarchitecturefor sEMG-basedgesturerecognition.PLoSONE 13(10):e0206049.https://doi.org/10.1371/journal.pone.0206049Editor:HuiguangHe, ChineseAcademyofSciences,CHINAReceived:April 11, 2018Accepted:October7, 2018Published:October30, 2018Copyright:©2018Hu et al. This is an openaccessarticledistributedunderthe termsof the CreativeCommonsAttribution License,whichpermitsunrestricteduse, distribution, and reproductioninany medium,provided the originalauthorandsourceare credited.DataAvailability Statement:Five benchmarkdatabasesusedin this manuscriptcan bedownloaded as follows:1) NinaProDB1&NinaProDB2,OfficialWebsite:http://ninaweb.hevs.ch/,   DatasetDownloadURL:https://datadryad.org/resource/doi:10.5061/dryad.1k84r,RelatedPaperDOI: https://doi.org/10.1038/sdata.2014.53 2)BioPatRec26MOV,OfficialWebsite:https://github.com/biopatrec/biopatrec,DatasetDownloadURL:https://github.com/biopatrec/biopatrec/tree/Data_Repository/6mov8chFUS, RelatedPaperDOI:https://doi.org/10.1186/1751-0473-8-113)CapgMyo-DBa, OfficialWebsite:http://zju-capg.recognitionplaysanimportantandfundamentalroleforcomputersorassistivedevicestounderstandhumanbodylanguage.ThetraditionalsEMG-basedgesturerecognitionframeworkconsistsofdatapreprocessing,featureextraction,featureselectionandgestureclassification.Amongthesestages,featureextractionandgestureclassificationaretwoimportantstagesinsEMG-basedgesturerecogni-tionframework.Therefore,researchershavefocusedonpresentingdiscriminativefeaturesetswithdomainknowledge[11–15],aswellasemployingconventionalmachinelearningalgo-rithmstoclassifyhandgestures[16–19].Theseworksoftenrequireexcessiveparametertuningandrichdomainknowledge.Inrecentyears,deeplearningtechniquesachievepromisingperformanceinvariousfields[20–23]andprovidea newperspectivetoanalyzesEMGforhandgesturesrecognition.Inspiredbytheexcellentperformanceofdeeplearningtechniques,theConvolutionalNeuralNetwork(CNN)hasbeenexploitedforsEMG-basedgesturerecognition[24–29].ParkandLee[24]proposeda CNNmodelwithadaptivefeaturelearningtoimprovetheinter-subjectaccuracy.TheCNN-basedsEMGgesturerecognitionwasstudiedin[25]whichachievedcom-parableperformancewithtraditionalmethodsontheNinaProdatabase.Genget al.[26,27]presenteda newCNNarchitectureforinstantaneoussEMGimagesandtherecognitionaccu-raciesare77.8%for52gestures,99.5%for8 gesturesand89.3%for27gesturesonthreesEMGbenchmarkdatabases.Duet al.[28]designeda semi-superviseddeepCNNframeworkwhichemployeddataglovetoprovideauxiliaryinformation.Overallspeaking,existingdeeplearningmethodsforsEMG-basedgesturerecognitionaremainlybasedonCNNarchitecture.However,thesEMGis a formofsequentialdatabyitsnature.Inthefieldofvideoclassificationandhumanactivityanalysis,thehybridCNN-RNNarchitecturehasobtainedgoodperformancewhencomparedwithpureCNN-basedapproaches[30–33].AimingatmodelingthetemporalinformationbetterthanconventionalCNN-basedarchitectures,weinvestigatea hybridCNN-RNNarchitectureforsEMG-basedgesturerecognitiontocapturebothspatialandtemporalinformation.Moreover,attentionmechanismhasbeenappliedtotheproposedhybridCNN-RNNarchitectureforit hasprovensuccessfulinsequentialdatamodeling(e.g.,machinetranslation[34],imagecaptiongenera-tion[35]andspeechrecognition[36]).Themaincontributionsofthisworkaretwofold:1.Weproposeanattention-basedhybridCNN-RNNarchitectureforsEMG-basedgesturerecognition,whichmodelsboththespatialandtemporalinformationofsEMGandfocusesonthesubsegmentswhichcontainmorediscriminativeinformationforgesturerecognition.ComparedwiththeCNNmoduleofproposedarchitecturewhichonlymod-elsthespatialinformation,it improvestherecognitionaccuraciesfrom83.5%to84.8%onthefirstsub-databaseofNinaPro(denotedasNinaProDB1),from73.4%to74.8%onthesecondsub-databaseofNinaPro(denotedasNinaProDB2),from83.9%to92.5%onasub-databaseofBioPatRec(denotedasBioPatRec26MOV),from97.7%to99.7%onasub-databaseofCapgMyo(denotedasCapgMyo-DBa)andfrom92.1%to94.9%onthecsl-hdemg,respectively.2.Motivatedbytheideaofsignalimage[37],wepresenta newsEMGimagerepresentationmethodbasedona featurevectorforsparsemulti-channelelectromyogramsignals.It rear-rangesfeaturevectorsbasedontheclassicalfeaturesetPhinyomark[13],andis evaluatedonthreesparsemulti-channelsEMGdatabasesusingtheCNN,hybridCNN-RNNandattention-basedhybridCNN-RNNframeworks,respectively.TheresultsshowthattheproposedsEMGimagerepresentationmethodis superiortotheexistingsEMGimageAttention-basedhybridCNN-RNNarchitecture forsEMGgesturerecognitionPLOSONE| https://doi.org/10.1371/journal.pone.0206049October30,20182 / 18org/myo/,DatasetDownloadURL:https://figshare.com/articles/Data_from_Gesture_Recognition_by_Instantaneous_Surface_EMG_Images_CapgMyo-DBa/7210397, RelatedPaperDOI: https://doi.org/10.1038/srep365714)csl-hdemg, OfficialWebsite:https://www.uni-bremen.de/en/csl/research/motion-recognition.html,DatasetDownloadURL:http://www.csl.uni-bremen.de/CorpusData/download.php?crps=cslhdemg,   RelatedPaperDOI:https://doi.org/10.1145/2702123.2702501.Funding:This workwas supportedby NationalKeyResearchand Development Program of China(No.2016YFB1001302),the NationalNaturalScienceFoundationof China(No. 61379067),and theNationalResearchFoundation,PrimeMinistersoffice,Singaporeunderits International ResearchCentrein SingaporeFundingInitiative.Competinginterests:The authorshave declaredthat no competinginterestsexist.representationmethod.Theimprovementsareatleast2.0%forNinaProDB1,7.4%forNinaProDB2and1.6%forBioPatRec26MOV.Theremainderofthepaperis organizedasfollows.Firstly,wereviewrelatedworksonsEMG-basedgesturerecognitionmethods,hybridCNNandRNNarchitecturesandtheatten-tionmechanism.Secondly,weintroducetheproposedattention-basedhybridCNN-RNNarchitectureforsEMG-basedgesturerecognition,anddescribethedetailsofthenewfeaturevectorbasedsEMGimagerepresentationmethods.Thirdly,weshowtheexperimentalresultsonfivebenchmarksEMGdatabases.Finally,wedrawtheconclusionanddiscussourfuturework.RelatedworkInthissection,wepresentrelatedworksonsEMG-basedgesturerecognitionmethods,thehybridCNN-RNNarchitecturesandattentionmechanismintheliterature.ThehandcraftedfeaturesandtraditionalmachinelearningclassifiershavebeenextensivelyresearchedinearlysEMG-basedgesturerecognitionframeworks.ExistingsEMG-basedhand-craftedfeaturescanbedividedintothreecategories[38]:timedomain,frequencydomain,andtime-frequencydomainfeatures.ManyresearchersfocusedonpresentingnewsEMGfeaturesbasedontheirdomainknowledge[14,15]oranalyzingexistingfeaturestoproposenewfea-turesets[13,39].TraditionalmachinelearningclassifiershavebeenemployedtorecognizesEMG-basedgestures,suchask-NearestNeighbor(kNN)[16],LinearDiscriminateAnalysis(LDA)[17,40,41],HiddenMarkovModel(HMM)[18,42],andSupportVectorMachine(SVM)[14,19].TheSVMis themostpopularclassifierinearlysEMG-basedgesturerecogni-tionframeworks.Patriciaet al.[19]utilizedGeodesicFlowKernelwithSVMclassifiertoclas-sify10gestures.Doswaldet al.[14]appliedSVMclassifierwithPearsonVIIUniversalKerneltorecognize5 gestures.Aselectromyogramsignalis sequentialdata,HMMis suitableformodelingelectromyogramsignalwithhiddeninformation.Yunet al.[42]usedHMMclassi-fiertocreatea signlanguagerecognitionsystembasedonsEMG.TheCNNarchitectureis themostwidelyuseddeeplearningtechniqueforsEMG-basedgesturerecognition,whichcanbedividedintotwocategoriesbasedondifferentevaluationmethods.Thefirststudyfocusesonimprovingrecognitionaccuracyofintra-sessionevalua-tion[25,26].Atzoriet al.[25]constructedsEMGimageswhichcontainbothspatialandtem-poralinformationandtraineda CNNmodeltoextracthigh-levelfeatures.Genget al.[26]provideda novelCNNmodeltoextractspatialinformationfromtheinstantaneoussEMGimagesandachievedstate-of-the-artperformance.Thesecondstudyis devotedtothediffer-encebetweensessionsorsubjects[24,27].ParkandLee[24]drawadaptationmethodintoCNNmodeltolearnbetterfeaturesforinter-subjectevaluation.Duet al.[27]applieddomainadaptationbasedontheGengNet[26]toimprovetheinter-sessionaccuracy.Zhaiet al.[29]extractedusefulinformationfromthesEMGspectrogramtoformsEMGimagesanda CNN-basedarchitecturewasemployedtomodeltherelationshipbetweensEMGimagesandgesturelabels.TheRNNarchitecturehasbeenappliedforsEMG-basedhandproblems,suchasposeesti-mation[43,44]andsEMGfeatureextraction[45,46].HiokiandKawasaki[43]presentedaneuralnetworkwithrecurrentstructuretoestimatefingerjointanglesusingsEMGsignal.Quiviraet al.[44]proposeda sEMG-basedhandposeestimationmethodusingRNNwithLSTMcells.It constructeda modelforpredictingthehandjointkinematicsthroughsEMGsignalsandcapturedhandposekinematicsaccurately.Amoret al.[45]appliedMyoarmbandtocollectsEMGsignalsforsignlanguagerecognitionandemployedtheRNNarchitecturetoextractfeaturesfromsequentialdataforanalyzingsignlanguagegestures.Shinet al.[46]Attention-basedhybridCNN-RNNarchitecture forsEMGgesturerecognitionPLOSONE| https://doi.org/10.1371/journal.pone.0206049October30,20183 / 18exploitedanRNNarchitecturewiththreeLSTMlayerstoextractfeaturesfromsEMGandInertialMeasurementUnit(IMU)signalsforKoreansignrecognition.ThehybridCNN-RNNarchitecturehasobtainedgoodperformanceinrecognitionofvideoandwearablesensors.EbrahimiKahouet al.[30]presenteda hybridCNN-RNNarchi-tectureforfacialexpressionanalysis.TheCNNandRNNmoduleofthearchitectureweretrainedseparately.Wuet al.[31]designeda hybriddeeplearningframeworktoextractspatial,short-termandlong-termfeatureswhichconsistoftwohybridCNN-RNNarchitectureandaregularizedfusionlayer.Ordo ́ñezandRoggen[32]proposeda deephybridCNN-RNNforactivityrecognitionwithmultimodalwearablesensors.Thisarchitectureprovideda naturalsensorfusionandmodeledtemporalinformationoftheactivity.Wanget al.[33]recom-mendeda novelCNN-LSTMmodeltosolvebothgesturerecognitionandposeestimationproblemwithonlyRGBvideos.TheCNNblockwasemployedtoextractspatialfeaturesfromeachframe,andtheproposedsequentiallysupervisedLSTM(SS-LSTM)usedauxiliaryknowl-edgeinsteadoftheclasslabeltosuperviselearningprocess.TheattentionmechanismhasbeeninjectedintoRNNarchitecturesforperformanceenhancementinmanyapplicationscenarios.Dzmitryet al.[34]proposedanRNNencoder-decodermodelwithattentionformachinetranslation.It jointlylearnedforalignmentandtranslationandachievedsignificantperformanceimprovementoverthebasicencoder-decodermethod.Kelvinet al.[35]introducedtwoattention-basedimagecaptiongeneratorsandtheresultsonthreebenchmarkdatabasesshowedtheeffectivenessofattention.Chorowskiet al.[36]presenteda novelattention-basedneuralspeechrecognitionarchitecture.Theper-formancewascomparabletothatofthetraditionalmethodsontheTIMITdataset.Songet al.[47]providedanend-to-endLSTMnetworkwithspatialandtemporalattentionmodulesforskeleton-basedhumanactionrecognition.Therecognitionaccuraciesontwobenchmarkdatabasesoutperformedotherstate-of-the-artmethods.Asmentionedabove,thehybridCNN-RNNarchitecturehasbeensuccessfullyappliedtoactivityrecognitionbasedonvideoandwearablesensors.Theattentionmechanismis alsoaneffectivewaytoenhancetheperformanceofRNNarchitecture.Sincetheelectromyogramsignalis noisierthanotherwearablesensorsignals[32],weextractthePhinyomarkfeatureset[13]ofeachchanneltogeneratenewsEMGimagesandemploydeepneuralnetworktoextractusefulinformationbetweeneachchannel.However,thegeneratedsEMGimageis a monochromeimageandhasmuchsmallerpixelresolutionsthannormalimagesorvideoframes.Wecarefullyfine-tuneparametersofeachlayerandaddlocally-connectedlayer[26]toourproposedattention-basedhybridCNN-RNNarchitecturewhichhasbeenappliedinsEMG-basedgesturerecognitionforthefirsttime.MethodsAttention-basedhybridCNN-RNNarchitectureTheattentionmechanismhasbeenproposedindeeplearningtolearnfromthewayahumanperceivesthereal-worldthatpayingattentiontodifferentregions[48].Themotorunitactionpotential(MUAP)generatesandpropagatesalongthemusclefibers[26,49]andmuscleshavevaryingimportanceincontributingtodifferenthandmovements[50].If thelearnedclassificationmodelcaneffectivelycapturetheseimportantfactorsoftheinvolvedmuscles,it maybringperformanceimprovementsonsEMG-basedgesturerecognition.Theattentionframeworkindeeplearningusuallymodelstheimportanceinsidethetrainingdatathroughweightsandhasbeensuccessfullyappliedtovarioustasks,suchasimagecaptiongeneration[35],speechrecognition[36],sentimentanalysis[51]andetc.Therefore,wefocusonhowtoembedtheattentionmechanismintotheclassificationmodelandAttention-basedhybridCNN-RNNarchitecture forsEMGgesturerecognitionPLOSONE| https://doi.org/10.1371/journal.pone.0206049October30,20184 / 18accordinglyproposea novelattention-basedhybridCNN-RNNarchitectureforsEMG-basedgesturerecognition(seeFig1).Theproposedarchitecturemodelsboththespatial-temporalinformationandimportanceoftheinputelectromyogramsignalsandthelayersconfigurationoftheproposednetworkareshowninTable1.EachsamplerecordedfromCelectrodeswithLframesis denotedasX.WefirstuseslidingwindowmethodtosplitXintosubsegmentswhicharedenotedas{X1,X2,. . .,XT}, whereT(T�L)is thenumberofsubsegmentsandalsotimestepsofRNN.EachsubsegmentXt,8t= 1,2,. . .,ThasNframeswiththesizeof1×C.Then,theXtis convertedintoanimageItwithsize(N×W×H),whereW×H=C,WandHarewidthandheightoftheimage,respec-tively.Thedetailedimagerepresentationmethodcanbeseeninsection.Giventheconvertedimages{I1,I2,. . .,IT}, CNNis appliedasfeatureextractortotransformthemintofeatureFig1.Proposedattention-basedhybridCNN-RNNarchitecture forsEMG-basedgesturerecognition.https://doi.org/10.1371/journal.pone.0206049.g001Table1.Thelayersconfigurationofproposedattention-basedhybridCNN-RNN.LayersNameConfigurationsModules1Conv164kernels,kernelsize(3×3)CNN2Conv264kernels,kernelsize(3×3)3LC164kernels4LC264kernels5FC1512outputs6FC2512outputs7FC3128outputs8LSTM1LSTM,512hiddenunitoutputsRNN9AttentionAttention10G-wayFCClassification11Softmaxhttps://doi.org/10.1371/journal.pone.0206049.t001Attention-basedhybridCNN-RNNarchitecture forsEMGgesturerecognitionPLOSONE| https://doi.org/10.1371/journal.pone.0206049October30,20185 / 18vectors{F1,F2,. . .,FT}. TheCNNmodelconsistsofsevenlayers.Thefirsttwolayersarecon-volutionallayerswith643×3 kernels,followedbytwolocally-connectedlayers.Thelocally-connectedlayerwith641×1 kernelsis employedtoextractlocalfeaturesofthesEMGimage.Batchnormalization[52]is usedforeachofthelayersmentionedbeforereducingtheinternalcovariateshift.Thelastthreelayersareallfully-connectedlayerswithbatchnormalization,anda dropoutwiththeprobabilityof0.5is appliedtothefirsttwofully-connectedlayers.Forthesequencemodelingstage,eachRNNunithasa dropoutwiththeprobabilityof0.5and512hiddenunits,followedbyaG-wayfully-connectedlayeranda softmaxclassifier.Gis thenum-berofgesturestoberecognized.Thefinallabelis decidedbyaverage-poolingofthesoftmaxoutputs.Therecurrentneuralnetworkcontainsfeedbackloopsandencodescontextualinformationofa temporalsequence.Giventheinputsequence{F1,F2,. . .,FT} (featurevectorsextractedfromCNNmodel),thehiddenstateshtandoutputsytcanbecalculatedasfollows:ht¼HðWihFtþWhhht