RESEARCHARTICLEVisualattentionmechanismandsupportvectormachinebasedautomaticimageannotationZhangangHaoID1☯*,   HongweiGe2☯, LongWang21Schoolof BusinessAdministration,ShandongTechnologyandBusinessUniversity, Yantai,Shandong,China,2Schoolof ComputerScienceandTechnology,DalianUniversity of Technology,Dalian,Liaoning,China☯Theseauthorscontributedequallyto thiswork.*zghao2000@sina.comAbstractAutomaticimageannotationnotonlyhastheefficiencyof text-basedimageretrievalbutalsoachievestheaccuracyof content-basedimageretrieval.Usersof annotatedimagescanlocateimagestheywantto searchbyprovidingkeywords.Currentlymostautomaticimageannotationalgorithmsdonotconsidertherelativeimportanceof eachregionin theimage,andsomealgorithmsextracttheimagefeaturesasa whole.Thismakesit difficultforannotationwordsto reflectsalientversusnon-salientareasof theimage.Userssearchingforimagesareusuallyonlyinterestedin thesalientareas.Weproposeanalgorithmthatintegratesa visualattentionmechanismwithimageannotation.A preprocessingstepdividestheimageintotwoparts,thesalientregionsandeverythingelse,andtheannotationstepplacesa greaterweightonthesalientregion.Whentheimageis annotated,wordsrelatingto thesalientregionaregivenfirst.Thesupportvectormachineusesparticleswarmoptimizationto annotatetheimagesautomatically.Experimentalresultsshowtheeffective-nessof theproposedalgorithm.1. IntroductionWiththedevelopmentofdigitalandInternettechnologies,therearemassivenumbersofdigi-talimagesontheInternet.It is alsobecomingharderandharderforuserstofindtheseimagesaccuratelyandquickly.ThedramaticincreaseinthenumberofimagesontheInternetcom-binedwiththesubjectivity,uncertaintyandlaboriousnessofmanualannotationhasledtoagradualfailuretoapplytext-basedimageretrieval(TBIR)tolarge-scaleimageretrieval[1].Incomparison,content-basedimageretrieval(CBIR)increasestheamountofeffortfromusers,oftenrequiringthemtoprovideinitialimagesasinputforthesearch.So,CBIRhasnotbeenusedwidely[2–5].Imageretrievalprocesscanbeindirectlychangedintotextretrievalbyauto-maticimageannotation[6–9].Thatis,usersneedtoprovideonlythequerykeywords,withthesystemreturningtheimagesassociatedwiththekeywords,whichis inlinewithmostusers’currenthabits.AutomaticimageannotationhasbecomeanimportantresearchtopicinPLOSONE| https://doi.org/10.1371/journal.pone.0206971November6, 20181 / 16a1111111111a1111111111a1111111111a1111111111a1111111111OPENACCESSCitation:Hao Z, Ge H, WangL (2018)Visualattentionmechanism and supportvectormachinebasedautomaticimageannotation. PLoSONE13(11):e0206971.https://doi.org/10.1371/journal.pone.0206971Editor:QinghuiZhang,NorthShoreLongIslandJewishHealthSystem,UNITEDSTATESReceived:June13, 2018Accepted:October23, 2018Published:November6, 2018Copyright:©2018Hao et al. This is an openaccessarticledistributedunderthe termsof theCreativeCommonsAttributionLicense,whichpermitsunrestricted use, distribution, andreproductionin any medium,providedthe originalauthorand sourceare credited.DataAvailability Statement:All Corel5Kimagesetare availablefromthe database:https://github.com/watersink/Corel5K.Funding:This workwas supportedby theShandongProvincialNaturalScienceFoundation,China,by grantno. ZR2017MG022.Competinginterests:The authorshave declaredthat no competinginterestsexist.thefieldofimageretrieval.Aslongastheimagecanbeaccuratelyannotated,goodresultscanbereturnedtotheuser.Segmentingimageis veryimportantforautomaticimageannotation,greatlyinfluencingtheannotationresults.Mostexistingautomaticimageannotationalgorithmsdonotconsidertherelativeimportanceofdifferentpartsoftheimagetotheuserwhensegmentingtheimage.Otherannotationalgorithmsdonotsegmenttheimageatallbutextractthewholeimageasafeature.Inthispaper,visualattentionmechanismis introducedintotheannotationprocess.Duringpre-processing,theimageis dividedintosalientandnon-salientregions.Duringanno-tation,salientregionsofa imageareweightedtogivethemhigherpriority.Thisweightingindirectlyenhancestheperformanceofimageretrieval(becausesearchkeywordsoftenreflecttheusers’interestonlyinthesalientregions)oftheimage.2. RelatedworkSincethispaperusesa supportvectormachine(SVM)forautomaticimageannotation,wedividedtheexistingautomaticimageannotationalgorithmsintotwocategories:automaticimageannotationusinga supportvectormachinesandautomaticannotationbasedonothermethods.AutomaticimageannotationbasedonSVM:Cusanoetal.proposeda classificationsys-temusingmulti-classsupportvectormachinesforautomaticimageannotationwhichcanbeusedforlarge-scalevideoandimagemanagement[10].Gaoetal.proposeda hierarchicalboostingalgorithmtoenhanceSVMimageclassifiertrainingforimageannotation[11].Ommasietal.proposedSVM-basedmethodstoannotatemedicalimages[12].Vermapro-poseda newlossfunctiontomaketheSVMmorerobust,solvingthreeproblemsinannota-tion:incompletelabels,fuzzylabels,structuraloverlap[13].Wuetal.proposeda featureselectionmethod,constructinga multi-classclassifierusingweightedprobabilitiesandanimprovedSVM[14].Yuetal.proposedanautomaticimageannotationalgorithmbasedonasuperpixelbagofwordsmodelandanSVMclassifier[15].Majidpouretal.usedprincipalcomponentsanalysis(PCA)toreducethenumberofcolorfeaturesfollowedbyanSVMforclassification[16].Jinetal.proposeda multi-labelimageautomaticlabelingframeworkusinganimprovedmulti-kernellearningSVM[17].Haoetal.proposedanautomaticimageannota-tionmethodbasedonparticleswarmoptimization(PSO)andsupportvectorclustering(SVC).TheyusePSOtooptimizetheSVCforautomaticimageannotation[9].Automaticimageannotationbasedonothermethods:Forimageannotation,Makadiaetal.proposeda newbaselinetechniquethatuseslow-levelimagefeaturesanda simpledis-tancealgorithmtofindthenearestneighborofa givenimage[18].Westonetal.proposedanautomaticannotationalgorithmforlarge-scaleimagedatasetsthatusessimultaneouslearning[19].Liuetal.proposeda multiviewHessianregularization(mHR)algorithmappliedtokernelleastsquaresandSVMsforimageannotation[20].Employingjaccardsimilarities,Johnsonetal.usedmultiplenon-parametricimagemetadatatoidentifyneighborsofrelatedimagesfol-lowedbya deepneuralnetworktoannotateimages[21].Tariqetal.proposeda strategythatperformeda tensoranalysisofnewimagestoevaluatethecontext,andthencombinedtheevaluatedcontentandtheimagecontenttolabelimages[22].Inordertosolvetheproblemwithincompletelabelsformanytrainingimagedatasets,Wuetal.usedincompletelabeldatatotrainclassifiers[23].Shinetal.proposeda deeplearningmodeltodetectdiseasewithinmedicalimages[24].Jingetal.proposeda newmulti-labellearningmethodthatintegratesmulti-labeldictionarylearningwithembeddingofsomeofthesametags[25].Radetal.pro-poseda newautomaticimageannotationmethodbasedonnon-negativematrixfactorization[26].Liuetal.usedkernellogisticregressiontoannotatenetworkimagesautomatically[27].VisualattentionmechanismandSVMbasedautomaticimageannotationPLOSONE| https://doi.org/10.1371/journal.pone.0206971November6, 20182 / 16Choietal.annotatedimagesbyanalyzingimagesandimage-relatedtext[28].Uricchioetal.proposeda labelpropagationframeworkbasedonkernelcanonicalcorrelationanalysis[29].Changetal.performedrapidimageannotationusingbrainstatedecodingandvisualpatternmining[30].Fromtheliteraturereview,wecanseethatalthoughtherearemanyworksforautomaticallyannotatingimages,thesemethodsrarelyconsidertherelativeimportanceofeachpartoftheimagetouserswhensegmentingimage.Therefore,thispaperintroducesa visualattentionmechanismtosolvethisproblem.WeusePSOtooptimizeanSVM,whichcanimprovetheaccuracyofimageannotation.3. Histogram-basedcontrastmethodThehistogram-basedcontrastmethod(HC)usestheimageglobalhistogramfeaturestoextractsalientregionsofimages,ina bottom-up,data-drivenapproach.Thegenerallyacceptedtheoryis thatcorticalcellsofthehumanbrainaregeneticallypredisposedtorespondtohighcontraststimulation.Basedonthistheory,a high-resolution,globalsaliencymapcontrastanalysisapproachis proposed:1.Basedontheglobalcontrastmethod,large-scaleobjectswillbeseparatedfromthesur-roundingenvironment.Thismethodoutperformsa localcontrastmethodthatproducessignificantvaluesonlyatorneartheedgeoftheobject.2.Globalconsiderationswillassignsimilarsalientvaluestosimilarregions,consistentlyhighlightingtheentiresalientobject.3.Thesignificanceoftheareawilldependmainlyontheareaaroundit,withdistantareashavinglessimpact.4.Thesaliencymapshouldbegeneratedsimplyandquicklytoaccommodatelarge-scaleimageprocessingandefficientimageclassificationandretrieval.AnHC-Mapbasedonhistogramcontrastwillbeusedtoassignpixelsignificantvaluesbasedoncolordifferencesfromotherpixels,producinganimagesaliencymapwithfullresolution.3.1.PixelsalientvalueBasedonthesensitivityofa visualsystemtothevisualsignalcontrastinbiologicalvision,ahistogram-basedcontrastmethodis proposedtodefinethesaliencyvalueofeachpixelintheimage.Specifically,thesaliencyvaluecalculationforeachpixelis obtainedbycalculatingitscontrastwitheveryotherpixel,thatis,thesalientvalueofthepixelintheimageis definedasformula(1).SðIkÞ¼X8Ii2IDðIk;IiÞð1ÞwhereD(Ik,Ii) is thedistanceofpixelIkandIiintheLabcolorspace.Formula(1)canbeexpandedtoformula(2).SðIkÞ¼DðIk;I1ÞþDðIk;I2Þþ. . .þDðIk;INÞð2ÞwhereNis thetotalnumberofpixelsintheimageI.Withthesedefinitions,it is easytoseethatpixelswiththesamecolorvaluehavethesamesalientvaluebecausethespatialrelationshipofthepixelsis ignored.Then,formula(2)canbeVisualattentionmechanismandSVMbasedautomaticimageannotationPLOSONE| https://doi.org/10.1371/journal.pone.0206971November6, 20183 / 16rearrangedsothatthevalueshavingthesamecoloraregroupedintooneclasswiththesaliencyvalueofeachcolorvalueobtainedasa result.SðIkÞ¼SðclÞ¼Xnj¼1fi�Dðcl;cjÞð3Þwhereclis thecolorvalueofthepixelIk;nis thenumberofcolorscontainedintheimage;fiistheprobabilityofcjintheimage.3.2.AccelerationbasedonhistogramThetimecomplexityofcalculatingthesalientvalueofeachpixelintheimagebyformula(1)isO(N2), whichhasveryhighcomputationalcostfora mediumsizedimage.Eq(3)is equivalenttoEq(2),butitstimecomplexityis reducedtoO(N)+O(n2), whichmeansthatifO(n2)�O(N),thetimecomplexityisO(N).Therefore,thereductioninthenumberofpixelcolorsbecomeskey.If theRGBcolorspaceis used,themaximumnumberofpossiblecolorsperpixelis 2563, fargreaterthanthetotalnumberofpixels.Inordertoreducethetotalnumberofcolors,wecanreducethenumberofcolorsperchan-nelto12from256andthetotalnumberofcolorscanbereducedto123= 1728.Colorsinactualuseareonlya smallpercentageofthetotalcolorspace,andcolorsthatappearlessfre-quentlycanbediscardedtofurtherreducethenumberofcolors.Byselectingthecolorsthatappearathighfrequencies,thenumberofpixelsinthesecolorsis guaranteedtoaccountfor95%ofthewholeimage.3.3.SmoothingcolorspaceAlthoughquantifyingcolorsandextractingcolorswithhighfrequencycaneffectivelyimprovethecomputationalefficiency,therearesomeshortcomingsinthequantificationitself.Somesimilarcolorsmaybeincorrectlyquantizedtocolorswithdifferentvalues.Toreducetheeffectofthisrandomnoiseonthecalculationofsaliencyvalues,theuseofa smoothingprocessforeachcolorwillimprovesaliencyvalues.Thespecificoperationreplacesthesaliencyvalueofeachcolorwitha weightedaveragevalueofthesaliencyvaluesofsimilarcolors(measuredintermsofdistanceintheLabcolorspace).Pickthem=n/4nearestcolortoimprovethecolorcsaliencyvalue.S0ðcÞ ¼1ðm