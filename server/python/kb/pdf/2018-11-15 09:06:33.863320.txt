METHODOLOGYOpen AccessTransition-transversion encoding andgenetic relationship metric in ReliefFfeature selection improves pathwayenrichment in GWASM. Arabnejad1, B. A. Dawkins2, W. S. Bush3, B. C. White1, A. R. Harkness4and B. A. McKinney1,2** Correspondence:brett-mckinney@utulsa.edu1Tandy School of ComputerScience, The University of Tulsa, 800S. Tucker Dr, Tulsa, OK 74104, USA2Department of Mathematics, TheUniversity of Tulsa, Tulsa, OK 74104,USAFull list of author information isavailable at the end of the articleAbstractBackground:ReliefF is a nearest-neighbor based feature selection algorithm thatefficiently detects variants that are important due to statistical interactions orepistasis. For categorical predictors, like genotypes, the standard metric used inReliefF has been a simple (binary) mismatch difference. In this study, we developnew metrics of varying complexity that incorporate allele sharing, adjustment forallele frequency heterogeneity via the genetic relationship matrix (GRM), andphysicochemical differences of variants via a new transition/transversionencoding.Methods:We introduce a new two-dimensional transition/transversion genotypeencoding for ReliefF, and we implement three ReliefF attribute metrics: 1.)genotype mismatch (GM), which is the ReliefF standard, 2.) allele mismatch (AM),which accounts for heterozygous differences and has not been used previouslyin ReliefF, and 3.) the new transition/transversion metric. We incorporate theseattribute metrics into the ReliefF nearest neighbor calculation with a Manhattanmetric, and we introduce GRM as a new ReliefF nearest-neighbor metric toadjust for allele frequency heterogeneity.Results:We apply ReliefF with each metric to a GWAS of major depressivedisorder and compare the detection of genes in pathways implicated indepression, including Axon Guidance, Neuronal System, and G Protein-CoupledReceptor Signaling. We also compare with detection by Random Forest andLasso as well as random/null selection to assess pathway size bias.Conclusions:Our results suggest that using more genetically motivatedencodings, such as transition/transversion, and metrics that adjust for allelefrequency heterogeneity, such as GRM, lead to ReliefF attribute scores withimproved pathway enrichment.Keywords:Machine learning, Feature selection, Genome-wide association study(GWAS), Genetic relationship matrix (GRM), Transition and transversion© The Author(s). 2018Open AccessThis article is distributed under the terms of the Creative Commons Attribution 4.0 InternationalLicense (http://creativecommons.org/licenses/by/4.0/), which permits unrestricted use, distribution, and reproduction in any medium,provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, andindicate if changes were made. The Creative Commons Public Domain Dedication waiver (http://creativecommons.org/publicdomain/zero/1.0/) applies to the data made available in this article, unless otherwise stated.Arabnejadet al. BioData Mining          (2018) 11:23 https://doi.org/10.1186/s13040-018-0186-4BackgroundReliefF is a nearest-neighbors feature selection algorithm that is known for its ability toidentify statistical interactions in high dimensional data [1, 2]. Specifically, it has beenshown to identify gene-gene interaction effects in simulated and real genome-wide associ-ation studies (GWAS) [2]. ReliefF uses what is called a“diff”function to determine nearestneighbors in the space of single nucleotide polymorphisms (SNPs) and to compute theimportance of a SNP based on its ability to separate cases and controls in the SNP space.While ReliefF analysis of GWAS data depends critically on its ability to measure thedegree of dissimilarity between genotype states, the diff function used up to this pointhas been extremely simple. For example, the standard ReliefF genotype diff betweentwo subjects is binary: the diff is 0 when the genotypes of the two subjects at a SNP areidentical and 1 if their genotypes are not identical. The distance between a pair of subjectsis obtained by summing the diff values in a city-block (Manhattan) metric across all SNPs.The binary nature of this standard diff is likely an oversimplification that misses informa-tion because there are degrees of difference between genotypes. In addition to a metricbased on allele-sharing differences, we develop a transition/transversion (Ti/Tv) metricthat accounts for physicochemical differences of nucleotides and a Genetic RelationshipMatrix (GRM) [3] metric that accounts for allele frequency heterogeneity.The main goal of the current study is to develop and compare combinations of met-rics between SNPs and subjects in ReliefF feature selection. We also compare with stat-istical learning feature selection methods Random Forest [4] and Lasso (least absoluteshrinkage and selection operator) [5]. Lasso has been used in GWAS [6, 7] but is para-metric and generally uses a strong independence assumption among features. RandomForest has also been applied to GWAS and has fewer constraints than regression,which is an advantage when a multivariate genetic architecture may be involved indisease susceptibility [8–10]. We previously used Random Forest and penalized logisticregression as methods for comparing epistasis detection in simulated data [11]. Whengenes interact and have no marginal effect, we found that Random Forest has limitedpower to detect gene-gene interactions in high dimensional data, which was confirmedin Ref. [12]. The diminished Random Forest importance scores for interacting variantsis attributable to the independence assumption in the tree node-splitting criterion.In the current study, we use enrichment of pathways related to major depressivedisorder (MDD) to compare feature selection methods. Early GWAS studies of MDDhad limited success at finding significant variants due to the contribution of many lociwith small effect sizes as well as the heterogeneous characteristics of MDD and thecomplex interaction between genetic variation and environmental factors [13]. In re-cent studies, many small main effect loci have been identified through theaccumulation ofextremely large samples [14, 15]. Identifying broad pools of regulating, modulating or inter-acting SNPs that confer risk for a target disorder is an important goal. For example, bipolardisorder (BD) may occur in a family in which there is a primary susceptibility gene, but themajority of BD may involve the interactions of multiple genes [16]. Detecting these inter-action effects with ReliefF may be improved by tailoring metrics to GWAS data.The current study is organized as follows. We describe the overall strategy, briefly re-view the relevant components of ReliefF, describe a new allele sharing ReliefF diff, developa new 2d transition/transversion genotype encoding and accompanying new ReliefF diff.We also introduce the first use of GRM to compute nearest hits and misses in ReliefF.Arabnejadet al. BioData Mining          (2018) 11:23 Page 2 of 17We apply ReliefF using combinations of diffs and metrics with other statisticallearning methods to 463 cases of MDD and 459 controls, and we test the top se-lected SNPs and their corresponding genes for overlap with biological pathwaysrelated to mental disorders. Our results suggest that using more genetically moti-vated metrics (allele sharing and Ti/Tv) and metrics that adjust for allelic hetero-geneity (standardization by allele frequency in GRM) lead to ReliefF scores thatimprove enrichment of biologically relevant pathways.MethodsThe goal of this study is to develop new ReliefF metrics for GWAS and comparethem based on their ability to enrich for genes in pathways that have prior evidencefor relevance to a phenotype. Our overall strategy (Fig.1) is to compare enrich-ment of known relevant pathways. The analysis for each feature selection methodinvolves four steps (left side Fig.1). First we filter with minor allele threshold 0.01and linkage-disequilibrium (LD) threshold 0.5 (Step 1, Fig.1), which results in281,648 SNPs prior to the application of each method. We choose the top SNPs fromeach feature selection method (Step 2) including ReliefF (Part A, Fig.1), Lasso (Part B,Fig.1), Random Forest (Part C, Fig.1) and Random Genes of size 500 (Part D, Fig.1). Thepurpose of Random Genes is to estimate the effect of pathway size on enrichmentdue to chance. For each method, we choose the number of tops SNPs so thatwhen we map SNPs to gene symbols (Step 3) we obtain 500 unique genes. Finally,we compare the number of genes detected for each of the biologically relevantpathways (Step 4).For ReliefF, we implement four methods for computing the nearest-neighbordistance matrix in our inbix software with --snp-metric-nn flag (Fig.2)andthreediff functions for computing the attribute importance score with --snp-metric-diff(Fig.2). The three attribute importance diffs incorporate increasing nucleotideFig. 1Overall evaluation strategy. (1) Preprocess the GWAS data by minor allele frequency and linkagedisequilibrium filtering, (2) Apply feature selection algorithms (purple, right panel A-D), (3) Map top SNPsfrom methods A-D to gene symbols, and (4) Map genes to the target pathways to compare enrichment.The feature selection algorithms (right panel) are (A) ReliefF with combinations of nearest-neighbor and diffmetrics (additional details in Fig.2), (B) Lasso penalized regression with principal component correction, (C)Random Forest permutation importance, and (D) random sets of genes to assess pathway size biasArabnejadet al. BioData Mining          (2018) 11:23 Page 3 of 17information: binary genotype mismatch (GM), allele mismatch (AM), and transition/transversion (Ti/Tv). Each of these diffs can be combined with a Manhattan metric tocreate three nearest neighbor methods. The Euclidean metric is also an option in our soft-ware. The last nearest-neighbor method is based on GRM. Each metric and diff functionis discussed in detail below. We focus on six combinations: each of the three diffs used inthe Manhattan metric for nearest neighbors and each of the three diffs used with GRM tocompute nearest neighbors.Relief feature selection algorithmThe goal of the Relief algorithm [17] is to estimate the importance of attributes accord-ing to how well their values distinguish between nearest neighbors from different clas-ses (e.g., cases and controls). The Relief algorithm uses a base“diff”function for thedistance matrix to compute nearest neighbors, but the diff is also used for computingattribute importance. Recently we reformulated the ReliefF weight in a compact math-ematical form as a difference of means between nearest misses and hits [18]. A hit isdefined for a given instance or subject Ri(i=1...m) as another instance that has thesame class label (case or control) as that of Ri, and a miss is another instance with adifferent class label from Ri. Once a distance matrix, D, is computed between all in-stances (discussed more below), the reformulated ReliefF score for SNPgν(ν=1...N)can be written as:WRgν¼Mgν−Hgν:ð1Þwhere the quantitiesFig. 2ReliefF combinations of metrics and diffs. We use three methods (two new) for computing theattribute diff value (Eqs.4, 5, 8): GM, AM, and TiTv (genotype mismatch, allele mismatch, and transition/transversion) with the flag --snp-metric-diff in our inbix software. These three diffs also can be combinedwith the Manhattan metric (Eq.9) to create three methods for computing the nearest neighbor distances inthe space of all SNPs with the --snp-metric-nn flag combined with --manhattan (Euclidean is also an optionbut we focus on Manhattan). The fourth nearest neighbor method is the genetic relationship matrix, whichdoes not use the diffs and is called by the grm option with --snp-metric-nn flag. We focus on sixcombinations of nearest neighbor and diff methods: each of the three diffs with Manhattan for nearestneighbors and each of the three diffs used with GRM to compute nearest neighborsArabnejadet al. BioData Mining          (2018) 11:23 Page 4 of 17Mgν¼1mkXmi¼1Xkj¼1diffgν;Ri;MjRiðÞ:ð2ÞandHgν¼1mkXmi¼1Xkj¼1diffgν;Ri;HjRiðÞ:ð3Þare the mean diffs with respect to SNPgνof all subjects Ri(i=1...m) from theirk-near-est-neighbor misses [Mj(Ri) in Eq. (2)] and hits [Hj(Ri) in Eq. (3)]. The k nearest missesfor a subject Ri, are the k subjects nearest to Ribut in a different phenotype class thanRi. Similarly, the set of hits of Riis the set of k subjects that are nearest to Riwhile be-ing in the same phenotype class as subject Ri. An importance weight of SNPgν(WR[gν])is higher if the average of the miss diffs for the instances is greater than the average hitdiffs. Thus, a SNP with a greater positive value of WR(i.e,.Mgν>Hgν) is a better pre-dictor of the phenotype because the genotypes of the SNP tend to separate instances indifferent classes more than instances in the same class. The diff function computes theamount that two genotypes are different for SNPgνbetween two subjects Riand Rj.Inthe next subsection, we discuss in detail the new and old diff functions that will becompared.New ReliefF diffs and metricsWe introduce three diff functions for measuring the genetic dissimilarity between pairs ofindividuals at a single locus. The first diff is the standard used in ReliefF for categoricalvariables, which we refer to as genotype mismatch (GM). The second metric accounts forallele sharing, which we refer to as allele mismatch (AM). The third diff further accountsfor mutation type through transition/transversion differences (Ti/Tv). These first threediffs will be used to compute attribute importance and to compute city-block (Manhattan)distances between subjects. We will discuss these nearest-neighbor metrics and thegenetic relationship matrix (GRM) in a later subsection.Genotype mismatchThe standard metric used by ReliefF for categorical variables uses a binary mismatchdiff. For SNPs, the genotype mismatch (GM) is a 0 or 1 difference between two individ-uals (R1,R2) for a SNP,gν, based on the individuals’genotypes. The diff function isdiffGMgν;R1;R2¼0;genotypegν;R1¼¼genotypegν;R21;otherwiseð4Þwhere genotype(gν,R1) is the genotype for individualR1for SNPgν. In other words, twoindividuals have zero diff if they have identical genotypes and they have unit diff if theyhave different genotypes.Allele mismatchA potential drawback of GM is that it is not sensitive to heterozygous genotype differ-ences when computing the diff. The following allele mismatch (AM) diff accounts for theArabnejadet al. BioData Mining          (2018) 11:23 Page 5 of 17difference in the number of alleles for a SNP when computing the difference between twoindividuals. The difference of two individuals can be calculated by the following formuladiffAMgν;R1;R2¼12jg1ν−g2νjð5Þwheregiνis the number of copies of the reference allele for theνthSNP of theithindi-vidual. In other words, the value ofg1νis the number of minor alleles in the genotype:0, 1 or 2. Then the return value of diffAM(gν,R1,R2) is 0, 0.5 or 1 when the two individ-ual have 2, 1 or 0 alleles in common, respectively.Transition/transversion 2d encoding and associated diffThe AM diff increases the sensitivity over the GM diff because with AM a hetero-zygous state is half the distance between either homozygous state. Next our goal isto incorporate additional physicochemicalinformation into the diff based on transi-tion and transversion mutations. A transition is a point mutation (blue arrows inFig.3) that changes a purine nucleotide to another purine (A↔G) (orange circlesin Fig.3) or a pyrimidine nucleotide to another pyrimidine (C↔T) (green squaresin Fig.3). Transversion refers to the substitution of a purine (A or G) for a pyr-imidine (C or T) or vice versa (red arrows in Fig.3)[19]. For the Ti/Tv diff func-tion, we classify genotypes as transitions or transversions and hypothesize that anallele mismatch at a transversion genotype is greater than the same mismatch for atransition genotype.Fig. 3Definition of transitions and transversions. Nucleotides A and G (orange circles) are in the purinefamily. Nucleotides C and T (green squares) are in the pyrimidine family. When alleles of a genotype areboth from the same family (both purine or both pyrimidine), the genotype is called a transition (bluearrows). When alleles of a genotype are each from the opposite family (one purine and pyrimidine), thegenotype is called a transversion (red arrows)Arabnejadet al. BioData Mining          (2018) 11:23 Page 6 of 17Before constructing the Ti/Tv diff, we first introduce a 2d Ti/Tv genotype encoding(Fig.4) in which a genotype is a point on a unit circle in the Cartesian plane with basisvectorsex= (1, 0) andey= (0, 1). Below we use Dirac bra-ket notation, where |x〉repre-sents a column vector and〈x| represents a row vector. An example of this encoding thatis appropriate for transversion genotypes or an additive encoding (red arrows in Fig.4)has the two homozygous states orthogonal (θ=π/2) to each other: |aa〉Tv=exon thehorizontal axis and |AA〉Tv=eyon the vertical axis. And then the heterozygous state is anequal mixture (θ=π/4) of the homozygous states:jAa〉Tv¼ð1ffiffi2p;1ffiffi2pÞ.For transition mutations, we want our encoding to contract the distance (relative totransversion encoding) between two homozygous states and between a homozygousstate and the heterozygous state (blue arrows, Fig.4). Again we let the heterozygousstate bejAa〉Ti¼ð1ffiffi2p;1ffiffi2pÞ, centered on the diagonal (θ=π/4) like transversions, but in-stead of being orthogonal, the homozygous states are contracted toward the diagonalwith an angle of separationθ=π/6.Fig. 4Two-dimensional transition/transversion genotype encoding. Genotypes are represented as vectorson a unit circle and their similarity is the cos2θof their angular separation. Transversion genotype vectors(red) are more expanded than transitions (byπ/4) to account for the alleles (A and a) coming from differentnucleotide families (one purine and one pyrimidine). Transition genotype vectors (blue) are morecompressed together (byπ/6) to account for the alleles (A and a) coming from the same nucleotide family(both purine or both pyrimidine). For both transition and transversion SNPs, we center the heterozygousgenotype vector atπ/4Arabnejadet al. BioData Mining          (2018) 11:23 Page 7 of 17We use |ψi(gν)〉to represent the six possible 2d Ti/Tv genotypes (Fig.4) for individ-ual Rifor SNPgν. The TiTv similarity between two individuals (R1and R2) for SNPgνisthe squared dot product of the individuals’Ti/Tv encoding (|ψ1(gν)〉and |ψ2(gν)〉):simTiTvgν;R1;R2¼ψR1gνjψR2gν
2¼cos2θ12ðÞð6ÞwherehψR1ðgνÞjψR2ðgνÞiis Dirac notation for the dot product of the Ti/Tv genotypevectors and〈ψR1ðgνÞjis the transpose of the column vectorjψR1ðgνÞ〉. From Eq. (6),the diff can be written asdiffTiTvgν;R1;R2¼1−simTiTvgν;R1;R2ð7ÞordiffTiTvgν;R1;R2¼1−ψR1gνjψR2gν
2:ð8ÞIfgνis a transversion and individual R1has homozygous genotypejψR1ðgνÞ〉¼jAA〉Tvand R2has heterozygous genotypejψR2ðgνÞ〉¼jAa〉Tv, then the diff value isdiffTiTvgν∈Tv;R1;R2¼1−AAjAahiTv2¼1−0;1ðÞ∙1ffiffiffi2p1ffiffiffi2p0BB@1CCA2¼1−12¼12:For two individuals at a transversion SNP that are opposite homozygotes(jψR1ðgνÞ〉¼jAA〉TvandjψR2ðgνÞ〉¼jaa〉Tv):diffTiTvgν∈Tv;R1;R2¼1−AAjaahiTv2¼1−0;1ðÞ∙102¼1−0¼1:Thus, the Ti/Tv diff for transversion SNPs is equivalent to AM because a heterozy-gous state is half the distance between either homozygous state.Repeating the above examples for the transition encoding, the diff betweenjψR1ðgνÞ〉¼jAA〉TiandjψR2ðgνÞ〉¼jAa〉TiisdiffTiTvgν∈Ti;R1;R2¼1−AAjAahiTi2¼1−1=2;ffiffiffi3p=2∙ffiffiffi3p=21=22¼1−34¼14:For individuals that are opposite homozygotes (jψR1ðgνÞ〉¼jAA〉TiandjψR2ðgνÞ〉¼jaa〉Ti):diffTiTvgν∈Ti;R1;R2¼1−AAjaahiTi2¼1−1=2;ffiffiffi3p=2∙102¼1−14¼34:By design, this encoding causes the Ti homozygous diffs (3/4 difference) to be smallerthan diffs between Tv homozygous states (1 difference) because transition mutationsstay in the same biochemical family (purine to purine or pyrimidine to pyrimidine).Similarly, the encoding causes diffs between heterozygous and homozygous Ti geno-types (1/4 difference) to be smaller than the corresponding Tv diffs (1/2 difference).We catalog the output of the GM, AM, and Ti/Tv diff functions for all combinationsof genotypes and for the cases when the SNP is a transition or transversion (Table1).The GM diff (green) treats homozygous differences (AA vs aa) the same as a heterozygousArabnejadet al. BioData Mining          (2018) 11:23 Page 8 of 17difference (AA vs Aa) or (aa vs Aa). The AM diff (orange) is sensitive to allele differencesbetween homozygotes (AA or aa) and heterozygotes (Aa), where the difference is 1/2 ofthe homozygous difference. However, AM does not distinguish between transition andtransversion genotypes. The Ti/Tv diff (blue) is also sensitive to allele differences butfurther distinguishes between transition and transversion allele changes, treating transi-tion genotypes as more similar than the corresponding transversion genotypes. In thisstudy, we focus on biallelic SNPs. The cases of tri-allelic and copy number variation maybe interesting future modifications.Nearest-neighbor distances based on Manhattan metric and the genetic relationship matrix(GRM)We compare the above diffs (GM, AM, Ti/Tv) (Eqs.4, 5, 8) based on their influence inthe attribute importance score (Eqs.1–3). However, the diff may also be used todetermine the distance between subjects by summing the absolute value of the diffsbetween a pair of subjects Riand Rjfor all genetic variantsgν(ν=1...N) in a city-blockmetric (Eq.9 below). The standard ReliefF nearest-neighbor distance matrix forcategorical variables uses the diff=diffGM(Eq.4) in the following metric:Dcityij¼XNν¼1diffgν;Ri;Rj:ð9ÞHowever, one may also replace diff=diffAM(Eq.5) or diff=diffTiTv(Eq.8) in Eq. (9).Regardless of the diff, when an attribute’s importance score is calculated, it uses the kTable 1.Comparison of the diff(gν,Ri,Rj) between individualsRiandRjfor SNPgνfor differentgenotype combinations using GM (green, Eq.4), AM (orange, Eq.5), and Ti/Tv (blue, Eq.8) for allcombinations of genotypes and for the cases when the SNP is a transition or transversionThe GM diff (green) treats homozygous differences (AA vs aa) the same as an allele difference (AA vs Aa) or (aa vs Aa).The AM diff (orange) is sensitive to allele differences between homozygotes (AA or aa) and heterozygotes (Aa). The TiTvdiff (blue) is sensitive to allele differences but further distinguishes between transition and transversion allele changes,treating transition genotypes as more similar than the corresponding transversion genotypesArabnejadet al. BioData Mining          (2018) 11:23 Page 9 of 17nearest neighbors as determined in the space of all other attributes, which allowsReliefF to identify important attributes that may involve complex higher-order inter-action architecture.We also propose a more sophisticated metric for computing the nearest-neighbor dis-tance matrix based on the Genetic Relationship Matrix (GRM) from GCTA. The GRMis used to calculate the genetic relatedness between pairs of individuals in the space ofN SNPs [3, 20]. We define the following GRM distance matrix between individual i andj,DGRMij¼ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi2N1−Aijq;ð10ÞwhereAij¼1NXNν¼1giν−2pνgjν−2pν2pν1−pνðÞð11Þandgiνis the number of copies of the reference allele for theνthSNP of theithindivid-ual andpνis the frequency of the reference allele [3]. Each genotype in the summand isstandardized bypνto account for the differences in allele frequency between SNPs. Inaddition to comparing diff functions (Eqs.4, 5, 8) in the attribute importance score, wealso compare Manhattan (Eq.9) and GRM (Eq.10) methods for computing the pair-wise distances to find nearest neighbors.Non Relief-based comparison methods: Random Forest, lasso, and random geneRandom Forests (RF) is a widely used machine learning classifier and feature selectorthat grows an ensemble of classification trees in bagged samples with random attributeselection [21]. To measure the importance of a feature after training, the values of thatfeature are permuted among the training data and the out-of-bag error is again com-puted on this perturbed data set. The importance score for the feature is computed byaveraging the difference in out-of-bag error before and after the permutation over all treesand the score is normalized by the standard deviation of these differences [4, 22–24]. Weused the“Ranger”implementation of Random Forest, which is included in our inbixsoftware to compute classification and variable importance.We used the PLINK software to perform Lasso (--lasso). We adjusted for the first fiveprincipal components, and the PCs were not subject to model selection. The top Lassovariants were chosen by top regression coefficients. We used h2= 0.5 as the estimate ofthe heritability to calibrate the regression and we usedλmin= 0.001 for the L1 penaltyparameter. Finally, we generated lists of random genes as a null comparison list thatshows the effect of pathway size on enrichment. A random set of 500 genes is randomlysampled 100 times and the average overlap of the 500 genes is computed for each path-way. Estimating the expected number of overlapping genes by chance helps to calibratethe overlaps of each pathway for the non-random feature selection methods.ReliefF software implementationWe performed all preprocessing and ReliefF analyses using ourInteraction-NetworkBIonformatics ToolboX(inbix) software for machine learning and epistasis network ana-lysis for high-dimensional data. Inbix is a free, open-source, command-line bioinformaticsArabnejadet al. BioData Mining          (2018) 11:23 Page 10 of 17tool, written in C++ and designed to perform a range of large-scale analyses with compu-tational efficiency. The source is publicly available from our website and github(http://insilico.utulsa.edu/index.php/inbix/and   https://github.com/insilico/inbix)[18, 25,26]. The inbix tool supports the PLINK format and includes PLINK algorithms and util-ities [27] along with new machine learning and network analysis methods. In our inbixsoftware, we use the following command to execute ReliefF with a GWAS binary bed file<bed-file>.bed and a file containing phenotype information <pheno-file>.pheno:./inbix --bfile <bed-file> --relieff --pheno <pheno-file> --snp-metric-nn <nn-metric>--snp-metric-diff <diff-metric> --out <results-file>where <diff-metric> can take on values gm, am, or ti/tv and <nn-metric> can also takeon values gm, am, or titv with manhattan or Euclidean for combining the individualSNP diffs. The user may alternatively select grm in <nn-metric>, which uses GRM asthe nearest-neighbor metric and does not use the diffs. Any combination of <diff-metric> or <nn-metric> is allowed. For the MDD GWAS with 922 individuals and281,648 SNPs (after filtering), the GRM metric takes approximately 8 hours and theother metrics take approximately 12 hours of CPU time (additional details in theAdditional file1).We use the constant-k ReliefF algorithm in inbix with the diffs and metrics describedabove. With inbix it is possible to optimize the number of neighbors for each attribute[18]. However, for this study, we use the constant value,k=⌊m/6⌋, for ReliefF nearestneighbors, where m is the number of samples. The valuek=⌊m/6⌋is the inbix defaultand was chosen based on Ref. [28] where it was shown to approximate the adaptiveradius Relief method, MultiSURF [29], which balances power to detect epistatic effectsand main effects.GWAS data, filtering and mappingIn this study we compare ReliefF metrics with each other and with other analysismethods based on enrichment of selected features in functional pathways for MDD.We used a recent GWAS of MDD [30] that includes 922 European individuals thatwere recruited through a survey of 1259 individuals who filled out forms and telephoneinterviewed for DSM-IV covering depressive, bipolar, psychotic, alcohol, substance andanxiety disorders as well as family history of mood disorders. After exclusions, ex-tracted DNA was genotyped with the Illumina Omni1-Quad microarray for 463 casesof MDD and 459 controls. For all ReliefF analyses, we used constantk=⌊m/6⌋= 138nearest neighbors.Filtering and mapping of genes and pathwaysAdditional details of data processing and analysis, including command line scripts, isprovided in the Additional file1. In the initial steps of analysis, dimensionality reduc-tion is performed on SNPs by linkage disequilibrium (LD) with threshold 0.5 and minorallele frequency threshold 0.01. The goal of this filtering is to remove highly redundantand very low signal data as well as obtain a manageable number of variants for machinelearning analysis (we obtain 281,648 variants).Arabnejadet al. BioData Mining          (2018) 11:23 Page 11 of 17A list of ranked SNPs for each method is obtained from the algorithms to be compared(Fig.1 method overview). We use Ensembl IDs to map the top SNPs to genes [31]. Giventhe rs-number of a SNP, the algorithm finds the location of the variant relative to genes,and the SNP is mapped to the gene symbol of the closest gene [32]. In the supplement,we include a link to our webservice that accepts a list of SNP rs-numbers and returnsmapped genes to a table, and we include the R code for the mapping. Despite LD pruning,many top SNPs will map to the same gene; thus, we begin the mapping with more than500 top SNPs so that we end up with 500 top unique genes.We then use Molecular Signatures Database (Msigdb) [33] to identify the number ofgenes in our top 500 gene selection lists that overlap with target pathways. The over-laps are based on HUGO gene symbols. Our goal is not to compute the statisticalsignificance of overlap for discovery, but to compare the number of genes found inknown pathways relative to other gene ranking methods. Thus, the size of the genebackground is not a concern. We also use random gene selection, mentioned above, toshow the expected amount of overlap with a pathway by chance.ResultsWe evaluate feature selection methods based on the number of genes found in pathwaysthat have been implicated in mood disorders (Figs.5, 6 and  7). We chose pathways relatedto G protein-coupled receptors (GPCRs) because they are implicated in pathophysiologyof MDD as well as bipolar disorder [34]. For example, current pharmacological interven-tions for MDD target neuromodulators (serotonin, norepinephrine, dopamine) that signalvia GPCR systems. The other two pathways, Axon Guidance and Neuronal System, havebeen hypothesized to play an important role in mood disorder pathophysiology. In05101520GM−GMReliefFGRM−GMReliefFRandomForestLassoRandomGenesRanking MethodsNumber of GenesAxon GuidanceNeuronal SystemSignaling By GPCRFig. 5Pathway detection comparison of standard ReliefF (GM-GM) and ReliefF with GRM nearest neighbors(GRM-GM). Bars count the number of genes that overlap the given pathway–Axon Guidance (light blue),Neuronal System (dark blue), and G protein-coupled receptor (GPCR) (green)–from the top 500 genesfrom each feature selection method. The methods are GM-GM (standard ReliefF with GM-based nearestneighbors (Eqs.4 and 9) and GM attribute diff (Eq.4)), GRM-GM (ReliefF with GRM-based nearest neighbors(Eq.10) and standard GM attribute diff (Eq.4)), where GM is genotype mismatch and GRM is geneticrelationship metric. In addition to ReliefF methods, we compare with Lasso corrected for principalcomponents, Random Forest, and Random Genes (random sampling of 500 genes averaged over 100replicates). GRM-GM detects more genes than other methods with the exception of GM-GM and RandomForest finding more Axon genesArabnejadet al. BioData Mining          (2018) 11:23 Page 12 of 1705101520AM−AMReliefFGRM−AMReliefFRandomForestLassoRandomGenesRanking MethodsNumber of GenesAxon GuidanceNeuronal SystemSignaling By GPCRFig. 6Pathway detection comparison of AM-AM ReliefF and GRM-AM ReliefF. Bars count the number of genesthat overlap the given pathway–Axon Guidance (light blue), Neuronal System (dark blue), and G protein-coupled receptor (GPCR) (green)–from the top 500 genes from each feature selection method. The methodsare AM-AM (ReliefF with AM-based nearest neighbors (Eqs.5 and   9) and AM attribute diff (Eq.5)), GRM-AM(ReliefF with GRM-based nearest neighbors (Eq.10) and AM attribute diff (Eq.5)), where AM is allele mismatchand GRM is genetic relationship metric. In addition to ReliefF methods, we compare with Lasso with principalcomponent covariates, Random Forest, and Random Genes (random sampling of 500 genes averaged over 100replicates). AM-AM and GRM-AM have a similar pattern to and better performance than Random Forest. GRM-AM finds the most Axon and GPCR genes, and AM-AM finds the most Neuronal genes05101520TiTv−TiTvReliefFGRM−TiTvReliefFRandomForestLassoRandomGenesRanking MethodsNumber of GenesAxon GuidanceNeuronal SystemSignaling By GPCRFig. 7Pathway detection comparison of TiTv-TiTv ReliefF and GRM-TiTv ReliefF. Bars count the number ofgenes that overlap the given pathway–Axon Guidance (light blue), Neuronal System (dark blue), and Gprotein-coupled receptor (GPCR) (green)–from the top 500 genes from each feature selection method.The methods are TiTv-TiTv (ReliefF with TiTv-based nearest neighbors (Eqs.8 and 9) and TiTv attribute diff(Eq.8)), GRM-TiTv (ReliefF with GRM-based nearest neighbors (Eq.10) and TITv attribute diff (Eq.8)), whereTiTv is transition/transversion diff and GRM is genetic relationship metric. In addition to ReliefF methods, wecompare with Lasso with principal component covariates, Random Forest, and Random Genes (randomsampling of 500 genes averaged over 100 replicates). TiTv-TiTv has a similar pattern to but betterperformance than Random Forest. GRM-TiTv finds the most GPCR genes, and TiTv-TiTv finds the most Axonand Neuronal genesArabnejadet al. BioData Mining          (2018) 11:23 Page 13 of 17addition to ReliefF metrics, we compare with feature selection by Lasso, Random Forest,and the average of random gene selection to assess the number of genes expected bychance due to pathway size.We compare combinations of ReliefF attribute diff functions for use in the average missand hit calculations (Eqs.2 and   3) and metrics for computing nearest neighbors in the fullspace of SNPs. The diff functions are GM, AM, and Ti/Tv (Eqs.4, 5,and8) and nearestneighbor metrics are the Manhattan metric (Eq.9) with the GM, AM and Ti/Tv diffs andthe GRM metric (Eq.10). We compare the three combinations of <diff-metric> and twopossible <nn-metric> for a total of 3x2=6 combinations (Figs.5, 6 and   7). We combinethe three diffs with the same diff in a Manhattan metric to form the first three“<nn-dif-f>-<attribute-diff>”combinations: GM-GM, AM-AM, TiTv-TiTv. We also combine thethree diffs with GRM nearest-neighbor metric to form the other three“<GRM-nn>-<attri-bute-diff>”combinations: GRM-GM, GRM-AM, GRM-TiTv.We first note that for random gene selection (“Random Genes”on right-most side ofFigs.5, 6 and 7), the pathway overlap is correlated with the size of each pathway. Asexpected, choosing random genes will result in a certain amount of overlap with apathway by chance in proportion to the size of the pathway. All methods perform bet-ter than chance (“Random Genes”) for detecting all pathways. For the Axon Guidancepathway, TiTv-TiTv (Eq.8 for the Manhattan metric and attribute diff) detected themost genes (light blue, Fig.7). For Signaling by GPCR pathway, GRM-TiTv (GRM near-est neighbor metric and TiTv attribute diff) detected the most genes (green, Fig.7). ForNeuronal System, GRM-GM performed best (dark blue, Fig.5).Increasing in complexity of the diff (GM, AM, TiTv in Figs.5, 6 and7, respect-ively), shows pathway enrichment increasing when the attribute diff is used in theManhattan metric (GM-GM < AM-AM < TiTv-TiTv). This suggests a benefit toincluding transition/transversion information in the attribute diff calculation for at-tribute importance. When the diffs are combined with GRM, the GPCR pathwayenrichment increases significantly. TheGRM metric adjusts for heterogeneity ofallele frequencies, and detecting genes that contain SNPs with such heterogeneitylikely benefits from GRM.Discussion and conclusionsMachine learning feature selection is a powerful tool for discovery in large data likeGWAS with complex population and interaction structure. ReliefF is particularlyefficient and powerful at selecting genes that are enriched for gene-gene interactions.However, in past studies, the diff function used to compute nearest neighbors and forupdating attribute importance has treated information about SNPs simplistically. Thus,we introduced more complex and genetically relevant mathematical functions for com-puting diffs, including the development of a new 2d transition/transversion genotypeencoding and associated diff. To find nearest neighbors, ReliefF implementations typic-ally use a Manhattan metric of the attribute diffs. Euclidean can also be used to com-bine diffs, but past results have indicated little difference with Manhattan. AMahalanobis distance function has also been developed, which allows for non-sphericalneighborhoods [35]. In addition to Manhattan with the new diff functions, we used thegenetic relationship matrix (GRM) to compute nearest-neighbor distances, which hasnot been used previously in ReliefF.Arabnejadet al. BioData Mining          (2018) 11:23 Page 14 of 17When testing for pairwise epistatic effects in a linear model, one may decompose theepistatic effects into additive and dominant encodings [36]. ReliefF has less flexibility tomix encodings than a pairwise-SNP linear model; however, ReliefF ranks SNPs withinthe context of all other SNPs in the dataset, which may include pairwise andhigher-order interactions. In our approach, we are able to mix encodings in a givenReliefF analysis by using different diff functions for attribute importance (Eqs.1–3) andfor finding nearest neighbors (Eqs.9 or 10). The GM diff is based on a dominantsingle-locus encoding and the AM diff is based on an additive encoding. The Ti/Tv diffis based on a new 2d Ti/Tv encoding where a genotype is mapped onto a unit sphereand contracts transition genotypes closer together than corresponding transversiongenotypes (Fig.4).For each method, the top 500 SNPs were mapped to genes and overlap with therelevant biological pathways for major depressive disorder (MDD) was calculated. Ourresults provide evidence that using either AM (Eq.5) or Ti/Tv (Eq.8) diffs in the attri-bute importance score calculation (Eqs.1–3) has an advantage over the simple GM diff(Eq.4). The detection of genes in certain pathways also can be improved by combiningthe attribute diffs with the GRM metric (Eq.10) for computing nearest neighbors.The GRM method for finding nearest neighbors has the useful property of adjusting foralleleic heterogeneity. Using GRM to compute nearest neighbors results in the best enrich-ment for two of the three pathways: GPCR Signaling with GRM-TiTv (green, Fig.7,GRMnearest neighbor metric and TiTv attribute diff) and Neuronal System with GRM-GM (darkblue, Fig.5). The 2d TiTv encoding is the same as the AM diff for transversion SNPs but re-sults in genotype differences that are contracted closer together for transition SNPs. UsingTiTv results in the best enrichment for the third pathway: Axon Guidance with TiTv-TiTv(light blue, Fig.7, TiTv used for the nearest neighbor metric diff and attribute diff).We focused on the analysis of real data as a proof of principle. Additional insightmay be obtained by using a simulation strategy that incorporates transition and trans-version differences that affect the phenotype. The challenge is to make such a simula-tion biologically realistic and not artificially biased toward one method. We usedReliefF’s simple nearest neighbor-finding method withk=⌊m/6⌋because it balances theability to find main effect and interaction effects [28]. However, there are otherRelief-based methods that may be used to optimize genetic findings. For example, onemay use an adaptive attribute-specific number of neighbors to improve power to detectmain effects and interaction effects [18]. One may also increase power through adaptiveradius versions of Relief, like SURF [37], MultiSURF [29], and STIR [28], or throughbackwards elimination versions of Relief, like iterative ReliefF.The ReliefF methods generally perform better than the non-ReliefF methods (RandomForest and Lasso). However, we note that no single analysis method can extract all infor-mation from a whole-genome association study (i.e., no free lunch) and each method findsunique gene signatures that can contribute to the overall picture of the pathway or pheno-type. Thus, combining metrics and feature selection methods may be a good strategy formaximizing the detection of relevant genes. There are opportunities to improve thesemethods by incorporating additional information about the biological properties of thedata, similar to phylogenetic substitution matrices or using coding/non-coding informa-tion. One may also assess the false discovery rate of different metrics using the STIRapproach for determining the statistical significance of Relief scores [28].Arabnejadet al. BioData Mining          (2018) 11:23 Page 15 of 17Additional fileAdditional file 1:Command line details to use inbix to perform GWAS filtering and pathway enrichment andfeature selection by random forest, lasso, and ReliefF with new transition-transversion diff and genetic relationshipmetric. (DOCX 35 kb)AcknowledgementsNot applicable.FundingThis work has been supported in part by The William K. Warren Foundation and the National Institute of GeneralMedical Sciences Center Grants P20GM121312 and P20GM103456. The content is solely the responsibility of theauthors and does not necessarily represent the official views of the National Institutes of Health.Availability of data and materialsReliefF and other methods used in this study are implemented in our command line bioinformatics tool calledinbix (http://insilico.utulsa.edu/index.php/inbix/), which is written in C++ and publicly available from GitHub(https://github.com/insilico/inbix).Author’s contributionsMA, BW, WB, AH, BD, and BM contributed to the design of the study. MA and BM wrote the manuscript. MA and BWperformed analyses. All authors revised the manuscript critically for important intellectual content and approved thefinal manuscript.Ethics approval and consent to participateNot applicable.Consent for publicationNot applicable.Competing interestsThe authors declare that they have no competing interest.Publisher’sNoteSpringer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.Author details1Tandy School of Computer Science, The University of Tulsa, 800 S. Tucker Dr, Tulsa, OK 74104, USA.2Department ofMathematics, The University of Tulsa, Tulsa, OK 74104, USA.3Institute for Computational Biology, Case Western ReserveUniversity, 2103 Cornell Road, Cleveland, OH 44106, USA.4Department of Psychology, The University of Tulsa, Tulsa, OK74104, USA.Received: 8 July 2018 Accepted: 22 October 2018References1.   Robnik-Šikonja M, Kononenko I. Theoretical and empirical analysis of ReliefF and RReliefF. Mach Learn. 2003;53:23–69.2.   Urbanowicz RJ, Meeker M, La Cava W, Olson RS, Moore JH. Relief-Based Feature Selection: Introduction and Review. JBiomed Inform. 2018;85:189-203.https://doi.org/10.1016/j.jbi.2018.07.014.3.   Yang J, Lee SH, Goddard ME, Visscher PM. GCTA: a tool for genome-wide complex trait analysis. Am J Hum Genet. 2011;88:76–82.4.   Breiman L. Random forests. Mach Learn. 2001:5–32.5.   Tibshirani R (2011) Regression shrinkage and selection via the lasso. J R Stat Soc Ser B (Statistical Methodol 73:273–282.6.   Jiang Y, He Y, Zhang H. Variable selection with prior information for generalized linear models via the prior LASSOmethod. J Am Stat Assoc. 2016;111:355–76.7.   Wang H, Aragam B, Xing EP (2017) Variable selection in heterogeneous datasets: a truncated-rank sparse linearmixed model with applications to genome-wide association studies. In: 2017 IEEE Int. Conf Bioinforma Biomed.IEEE, pp 431–438.8.   Brieuc MSO, Ono K, Drinan DP, Naish KA. Integration of Random Forest with population-based outlier analyses providesinsight on the genomic basis and evolution of run timing in Chinook salmon (Oncorhynchus  tshawytscha). Mol Ecol.2015;24:2729–46.9.   Stephan J, Stegle O, Beyer A. A random forest approach to capture genetic effects in the presence of populationstructure. Nat Commun. 2015;6:7432.10.  Li B, Zhang N, Wang Y-G, George AW, Reverter A, Li Y. Genomic prediction of breeding values using a subset of SNPsidentified by three machine learning methods. Front Genet. 2018.https://doi.org/10.3389/fgene.2018.00237.11.  McKinney BA, Crowe JE, Guo J, Tian D. Capturing the spectrum of interaction effects in genetic association studies bysimulated evaporative cooling network analysis. PLoS Genet. 2009;5:e1000432.12.  Winham SJ, Colby CL, Freimuth RR, Wang X, de Andrade M, Huebner M, Biernacka JM. SNP interaction detection withrandom forests in high-dimensional genetic data. BMC Bioinformatics. 2012;13:164.Arabnejadet al. BioData Mining          (2018) 11:23 Page 16 of 1713.  Levinson DF, Mostafavi S, Milaneschi Y, Rivera M, Ripke S, Wray NR, Sullivan PF. Genetic studies of major depressivedisorder: why are there no genome-wide association study findings and what can we do about it? Biol Psychiatry. 2014;76:510–2.14.  Hyde CL, Nagle MW, Tian C, Chen X, Paciga SA, Wendland JR, Tung JY, Hinds DA, Perlis RH, Winslow AR. Identification of15 genetic loci associated with risk of major depression in individuals of European descent. Nat Genet. 2016;48:1031–6.15.  Wray NR, Ripke S, Mattheisen M, et al. Genome-wide association analyses identify 44 risk variants and refine the geneticarchitecture of major depression. Nat Genet. 2018;50:668–81.16.  Craddock N, Jones I. Genetics of bipolar disorder genetics of. bipolar disorder. 1999:585–94.17.  Kira K, L a R. A practical approach to feature selection. Proc Ninth Int Work Mach Learn. 1992:249–56.18.  McKinney BA, White BC, Grill DE, Li PW, Kennedy RB, Poland GA, Oberg AL. ReliefSeq: a gene-wise adaptive-K nearest-neighbor feature selection tool for finding gene-gene interactions and Main effects in mRNA-Seq gene expression data.PLoS One. 2013;8:e81527.19.  Collins DW, Jukes TH. Rates of transition and Transversion in coding sequences since the human-rodent divergence.Genomics. 1994;20:386–96.20.  Vrieze SI, McGue M, Miller MB, Hicks BM, Iacono WG. Three mutually informative ways to understand the geneticrelationships among behavioral disinhibition, alcohol use, drug use, nicotine use/dependence, and their co-occurrence:twin biometry, GCTA, and genome-wide scoring. Behav Genet. 2013;43:97–107.21.  Chen CCM, Schwender H, Keith J, Nunkesser R, Mengersen K, Macrossan P. Methods for identifying SNP interactions: areview on variations of logic regression, random Forest and Bayesian logistic regression. IEEE/ACM Trans Comput BiolBioinforma. 2011;8:1580–91.22.  Qi Y. Random Forest for bioinformatics. Ensemble Mach Learn. 2012:307–23.23.  Reif DM, Motsinger AA, McKinney BA, Crowe JE, Moore JH (2006) Feature selection using a random forests classifier forthe integrated analysis of multiple data types. In: 2006 IEEE Symp. Comput. Intell. Bioinforma. Comput. Biol. IEEE, pp 1–8.24.  Meng YA, Yu Y, Cupples LA, Farrer LA, Lunetta KL. Performance of random forest when SNPs are in linkagedisequilibrium. BMC Bioinformatics. 2009;10(78).25.  Lareau CA, White BC, Oberg AL, Kennedy RB, Poland GA, McKinney BA. An interaction quantitative trait loci tool implicatesepistatic functional variants in an apoptosis pathway in smallpox vaccine eQTL data. Genes Immun. 2016;17:244–50.26.  Davis NA, Lareau CA, White BC, Pandey A, Wiley G, Montgomery CG, Gaffney PM, McKinney BA. Encore: geneticassociation interaction network centrality pipeline and application to SLE exome data. Genet Epidemiol. 2013;37:614–21.27.  Purcell S, Neale B, Todd-Brown K, et al. PLINK: a tool set for whole-genome association and population-based linkageanalyses. Am J Hum Genet. 2007;81:559–75.28.  Le TT, Urbanowicz RJ, Moore JH, McKinney BA. Statistical inference Relief (STIR) feature selection. Bioinformatics 2018Sep. 2018:18.https://doi.org/10.1093/bioinformatics/bty788.29.  Granizo-Mackenzie D, Moore JH. Multiple threshold spatially uniform reliefF for the genetic analysis of complex humandiseases. Lect Notes Comput Sci (including Subser Lect Notes Artif Intell Lect Notes Bioinformatics) 7833 LNCS. 2013:1–10.30.  Mostafavi S, Battle A, Zhu X, et al. Type I interferon signaling genes in recurrent major depression: increased expressiondetected by whole-blood RNA sequencing. Mol Psychiatry. 2014;19:1267–74.31.  Zerbino DR, Achuthan P, Akanni W, et al. Ensembl 2018. Nucleic Acids Res. 2018;46:D754–61.32.  McLaren W, Pritchard B, Rios D, Chen Y, Flicek P, Cunningham F. Deriving the consequences of genomic variants withthe Ensembl API and SNP effect predictor. Bioinformatics. 2010;26:2069–70.33.  Subramanian A, Tamayo P, Mootha VK, Mukherjee S, Ebert BL (2005) Gene set enrichment analysis : A knowledge-basedapproach for interpreting genome-wide.34.  Tomita H, Ziegler ME, Kim HB, et al. G protein-linked signaling pathways in bipolar and major depressive disorders.Front Genet. 2013;4:1–12.35.  Chang CC. Generalized iterative RELIEF for supervised distance metric learning. Pattern Recogn. 2010;43(8):2971–81.36.  Fish AE, Capra JA, Bush WS. Are interactions between cis-regulatory variants evidence for biological epistasis orstatistical artifacts? Am J Hum Genet. 2016;99:817–30.37.  Greene CS, Penrod NM, Kiralis J, Moore JH. Spatially uniform ReliefF (SURF) for computationally-efficient filtering ofgene-gene interactions. BioData Min. 2009;2:1–9.Arabnejadet al. BioData Mining          (2018) 11:23 Page 17 of 17BioMedCentralpublishesundertheCreativeCommonsAttributionLicense(CCAL).UndertheCCAL,authorsretaincopyrighttothearticlebutusersareallowedtodownload,reprint,distributeand/orcopyarticlesinBioMedCentraljournals,aslongastheoriginalworkisproperlycited.